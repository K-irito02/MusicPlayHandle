解决音乐播放器应用中的两个技术问题：

1. **最近播放列表异常更新问题**：
   - 现象：当我在一个标签中播放一首歌曲后，返回"最近播放"标签时，会更新两首歌曲记录
   - 其中一首是当前正在播放的歌曲（预期行为）
   - 另一首是该标签列表中位置第一的歌曲（非预期行为）
   - 问题：为什么未播放的标签首歌曲会被错误地添加到最近播放列表？

2. **最近播放列表去重问题**：
   - 当前行为：更新"最近播放"列表时，去重操作不彻底
   - 期望行为：完全删除旧记录，确保列表中没有重复条目

---------------------------------

## 问题分析

### 问题1：最近播放列表异常更新问题

**根本原因**：当设置播放列表时，`AudioEngine::setPlaylist()` 方法会自动设置当前索引为0，并触发 `currentSongChanged` 信号，导致列表第一首歌曲被错误地添加到播放记录中。

从代码可以看到：
```cpp
// 在 AudioEngine::setPlaylist() 中
m_currentIndex = validSongs.isEmpty() ? -1 : 0;  // 自动设置为0
if (m_currentIndex >= 0) {
    emit currentSongChanged(m_playlist[m_currentIndex]);  // 触发信号
}
```

### 问题2：最近播放列表去重问题

**根本原因**：当前的去重逻辑在数据库查询层面，但没有在UI更新时进行彻底的清理。

让我修复这两个问题：

现在我需要修改播放逻辑，确保在设置播放列表后正确设置当前歌曲：

现在我需要修改`onCurrentSongChanged`方法，添加更严格的检查，避免在设置播放列表时错误地添加播放记录：

现在我需要修改数据库查询，确保彻底的去重：

现在我需要简化代码中的去重逻辑，因为SQL查询已经确保了去重：
